.\" Man page generated from reStructuredText.
.
.TH "MONGOC_CLIENT_READ_WRITE_COMMAND_WITH_OPTS" "3" "Nov 03, 2021" "1.19.2" "libmongoc"
.SH NAME
mongoc_client_read_write_command_with_opts \- mongoc_client_read_write_command_with_opts()
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.SH SYNOPSIS
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
bool
mongoc_client_read_write_command_with_opts (
   mongoc_client_t *client,
   const char *db_name,
   const bson_t *command,
   const mongoc_read_prefs_t *read_prefs /* UNUSED */,
   const bson_t *opts,
   bson_t *reply,
   bson_error_t *error);
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Execute a command on the server, applying logic for commands that both read and write, and taking the MongoDB server version into account. To send a raw command to the server without any of this logic, use \fBmongoc_client_command_simple\fP\&.
.sp
Use this function for commands that both read and write, such as "mapReduce" with an output collection.
.sp
Read and write concern and collation can be overridden by various sources. In a transaction, read concern and write concern are prohibited in \fBopts\fP\&. The highest\-priority sources for these options are listed first in the following table. Read preferences are \fInot\fP applied. The write concern is omitted for MongoDB before 3.4.
.TS
center;
|l|l|l|.
_
T{
Read Concern
T}	T{
Write Concern
T}	T{
Collation
T}
_
T{
\fBopts\fP
T}	T{
\fBopts\fP
T}	T{
\fBopts\fP
T}
_
T{
Transaction
T}	T{
Transaction
T}	T{
T}
_
T{
\fBclient\fP
T}	T{
\fBclient\fP
T}	T{
T}
_
.TE
.sp
See the example for transactions and for the "distinct" command with opts\&.
.sp
\fBreply\fP is always initialized, and must be freed with \fI\%bson_destroy()\fP\&.
.sp
(The \fBmongoc_read_prefs_t\fP parameter was included by mistake when this function was introduced in libmongoc 1.5. A command that writes must not obey a read preference.)
.SH PARAMETERS
.INDENT 0.0
.IP \(bu 2
\fBclient\fP: A \fBmongoc_client_t\fP\&.
.IP \(bu 2
\fBdb_name\fP: The name of the database to run the command on.
.IP \(bu 2
\fBcommand\fP: A \fI\%bson_t\fP containing the command specification.
.IP \(bu 2
\fBread_prefs\fP: Ignored.
.IP \(bu 2
\fBopts\fP: A \fI\%bson_t\fP containing additional options.
.IP \(bu 2
\fBreply\fP: A location for the resulting document.
.IP \(bu 2
\fBerror\fP: An optional location for a \fBbson_error_t\fP or \fBNULL\fP\&.
.UNINDENT
.sp
\fBopts\fP may be NULL or a BSON document with additional command options:
.INDENT 0.0
.IP \(bu 2
\fBreadConcern\fP: Construct a \fBmongoc_read_concern_t\fP and use \fBmongoc_read_concern_append\fP to add the read concern to \fBopts\fP\&. See the example code for \fBmongoc_client_read_command_with_opts\fP\&. Read concern requires MongoDB 3.2 or later, otherwise an error is returned.
.IP \(bu 2
\fBwriteConcern\fP: Construct a \fBmongoc_write_concern_t\fP and use \fBmongoc_write_concern_append\fP to add the write concern to \fBopts\fP\&. See the example code for \fBmongoc_client_write_command_with_opts\fP\&.
.IP \(bu 2
\fBsessionId\fP: First, construct a \fBmongoc_client_session_t\fP with \fBmongoc_client_start_session\fP\&. You can begin a transaction with \fBmongoc_client_session_start_transaction\fP, optionally with a \fBmongoc_transaction_opt_t\fP that overrides the options inherited from \fBclient\fP, and use \fBmongoc_client_session_append\fP to add the session to \fBopts\fP\&. See the example code for \fBmongoc_client_session_t\fP\&.
.IP \(bu 2
\fBcollation\fP: Configure textual comparisons. See Setting Collation Order, and \fI\%the MongoDB Manual entry on Collation\fP\&. Collation requires MongoDB 3.2 or later, otherwise an error is returned.
.IP \(bu 2
\fBserverId\fP: To target a specific server, include an int32 "serverId" field. Obtain the id by calling \fBmongoc_client_select_server\fP, then \fBmongoc_server_description_id\fP on its return value.
.UNINDENT
.sp
Consult \fI\%the MongoDB Manual entry on Database Commands\fP for each command\(aqs arguments.
.SH ERRORS
.sp
Errors are propagated via the \fBerror\fP parameter.
.SH RETURNS
.sp
Returns \fBtrue\fP if successful. Returns \fBfalse\fP and sets \fBerror\fP if there are invalid arguments or a server or network error.
.sp
A write concern timeout or write concern error is considered a failure.
.SH EXAMPLE
.sp
See the example code for \fBmongoc_client_read_command_with_opts\fP\&.
.SH AUTHOR
MongoDB, Inc
.SH COPYRIGHT
2017-present, MongoDB, Inc
.\" Generated by docutils manpage writer.
.
